<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <meta name="author" content="aroujikarim"> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/png" href="favicon genius.png">
    <title>Genius</title>
</head>

<body>
  <header>
    <section id="content">
      <div class="container-header">
        <!-- Logo principal -->
        <a href="index.html">
          <img src="genius by ymg 2.svg" alt="Logo Enlightened" class="logo">
        </a>
  
        <!-- Menu desktop -->
        <nav class="nav-menu">
          <ul>
            <!-- Bloc sélection de langue -->
            <li class="language-selector">
              <select id="language-select">
                <option value="index.html">English</option>
                <option value="francais.html">Français</option>
              </select>
            </li>
  
            <!-- Liens de navigation -->
            <li><a href="index.html">Home</a></li>
            <li><a href="topics.html">Topics</a></li>
            <li><a href="events.html">Events</a></li>
            <li><a href="genius.html">Genius</a></li>
            <li><a href="contact.html">Contact</a></li>
          </ul>
        </nav>
  
        <!-- Icône hamburger -->
        <div class="hamburger" id="hamburger">
          <span class="bar"></span>
          <span class="bar"></span>
          <span class="bar"></span>
        </div>
  
        <!-- Menu mobile -->
        <nav class="nav-menu-mobile" id="navMenuMobile">
          <!-- Logo en haut -->
          <div class="mobile-header">
            <img src="genius by ymg.svg" alt="Logo Genius" class="mobile-logo">
          </div>
  
          <!-- Liens du menu -->
          <ul class="mobile-nav-links">
            <li><a href="index.html">Home</a></li>
            <li><a href="topics.html">Topics</a></li>
            <li><a href="events.html">Events</a></li>
            <li><a href="genius.html">Genius</a></li>
            <li><a href="contact.html">Contact</a></li>
          </ul>
  
          <!-- Carré essentials -->
          <div class="box">
            <p>Pursue your enlightenment :</p>
            <div class="social-icons">
              <a href="https://www.instagram.com/enlightened.genius/" target="_blank" class="instagram-link">
                <i class="fab fa-instagram"></i>
              </a>
            </div>
            <div class="separator-box"></div>
            <li class="language-selector">
              <select id="language-select-mobile">
                <option value="index.html">English</option>
                <option value="francais.html">Français</option>
              </select>
            </li>
          </div>
        </nav>
      </div>
    </section>
  </header>
  

      <hr style="height: 20% ; background-color: #8b949e; border: none;">

    
      
      <div class="introduction-bloc">
        <div class="bloc-header">
          <div class="separator"></div>
          <div class="bloc-title">On a quest</div>
        </div>
        <div class="bloc-text">
            Welcome to the place that meets your continuous need to enlighten your body.
        </div>
      </div>
      

      <div class="second-bloc">
        <div class="bloc-image">
          <img src="genius by ymg 2.svg" alt="image" />
        </div>
        <div class="separator"></div>
        <div class="bloc-content">
          <div class="bloc-title">Heavenly Enlightened</div>
          <div class="bloc-text">
            The notion of being heavenly enlightened, refers to a certain state which transcends basic enlightenement achived through knowledge. Here we refer to a divine knowledge, present only in the chosens ones.
          </div>
        </div>
      </div>

      <div class="third-bloc">
        <div class="bloc-header">
          <div class="separator"></div>
          <div class="bloc-title">Latest Discoveries</div>
        </div>
      
        <div class="video-grid">
      
          <div class="video-item">
            <a href="https://www.youtube.com/watch?v=5LKpnIHLkj0" target="_blank" class="video-preview">
              <img src="https://img.youtube.com/vi/5LKpnIHLkj0/hqdefault.jpg" alt="Vidéo 1">
            </a>
            <div class="video-title">New York: The Greatest City in the World?</div>
            <div class="video-meta">
              <div class="video-rating">
                <img src="star white.svg" alt="star" class="star-icon">
                <span class="rating-text">3.5 / 5</span>
              </div>
              <div class="meta-separator"></div>
              <span class="video-category">Geography</span>
            </div>
          </div>
      
          <div class="video-item">
            <a href="https://youtu.be/Y_VJmoibRhI?list=LL" target="_blank" class="video-preview">
              <img src="https://img.youtube.com/vi/Y_VJmoibRhI/hqdefault.jpg" alt="Vidéo 2">
            </a>
            <div class="video-title">France shows how Europe can survive Trump</div>
            <div class="video-meta">
              <div class="video-rating">
                <img src="star white.svg" alt="star" class="star-icon">
                <span class="rating-text">4.5 / 5</span>
              </div>
              <div class="meta-separator"></div>
              <span class="video-category">Geopolitics</span>
            </div>
          </div>
      
          <div class="video-item">
            <a href="https://www.youtube.com/watch?v=VHmo_TDLrLQ" target="_blank" class="video-preview">
              <img src="https://img.youtube.com/vi/VHmo_TDLrLQ/hqdefault.jpg" alt="Vidéo 3">
            </a>
            <div class="video-title">Why does South Africa still bear the traces of segregation ?</div>
            <div class="video-meta">
              <div class="video-rating">
                <img src="star white.svg" alt="star" class="star-icon">
                <span class="rating-text">3.8 / 5</span>
              </div>
              <div class="meta-separator"></div>
              <span class="video-category">Society</span>
            </div>
          </div>
      
        </div>
      </div> 
      
      
      <div class="fourth-bloc">
        <img src="genius by ymg 2.svg" alt="Genius by YMG Logo" class="logo">
        
        <div class="bloc-title">
          Latest Instagram Post
          <div class="title-underline"></div>
        </div>
        
        <div class="bloc-text">
          Take a look at our interesting latest Instagram post
        </div>
      
        <div class="insta-post">
          <a href="https://www.instagram.com/enlightened.genius/" target="_blank">
            <video src="post 26-04.mp4" controls></video>
          </a>
        </div>
      </div>
      
      <div class="topics-container">
        <h2 class="topics-title">Discover various topics</h2>
        <div class="title-separator"></div>
      
        <p class="topics-description">Explore a selection of key disciplines to broaden your understanding and curiosity.</p>
      
        <div class="topics-grid">
          <div class="topic-box">
            <div class="icon-text">
              <div class="topic-icon">
                <img src="icon geopolitics.svg" alt="Geopolitics Icon" />
              </div>
              <div class="vertical-separator"></div>
              <span class="topic-name">Geopolitics</span>
            </div>
          </div>
      
          <div class="topic-box">
            <div class="icon-text">
              <div class="topic-icon">
                <img src="icon physics.svg" alt="Physics Icon" />
              </div>
              <div class="vertical-separator"></div>
              <span class="topic-name">Physics</span>
            </div>
          </div>
      
          <div class="topic-box">
            <div class="icon-text">
              <div class="topic-icon">
                <img src="icon psychology.svg" alt="Psychology Icon" />
              </div>
              <div class="vertical-separator"></div>
              <span class="topic-name">Psychology</span>
            </div>
          </div>
      
          <div class="topic-box">
            <div class="icon-text">
              <div class="topic-icon">
                <img src="icon mathematics.svg" alt="Geography Icon" />
              </div>
              <div class="vertical-separator"></div>
              <span class="topic-name">Mathematics</span>
            </div>
          </div>
          <a href="topics.html" class="topics-button">Topics</a>
        </div>
      </div>

      <div class="yt-rec-container">
        <h1 class="yt-rec-title">Recommandations Vidéo IA</h1>
        <p class="yt-rec-description-text">Cliquez sur le bouton ci-dessous pour obtenir de nouvelles suggestions de vidéos YouTube sur des sujets variés.</p>

        <button id="ytRecRefreshButton" class="yt-rec-btn">
            <img id="ytRecRefreshIcon" src="icon ymg.svg" alt="Icône de rafraîchissement" class="yt-rec-icon" />
            Rafraîchir les Recommandations
        </button>

        <div id="ytRecLoadingSpinner" class="yt-rec-loading-spinner"></div>
        <div id="ytRecMessageBox" class="yt-rec-message-box"></div>

        <div id="ytRecRecommendationsContainer" class="yt-rec-video-grid">
            <div id="ytRecCard1" class="yt-rec-video-item yt-rec-hidden"></div>
            <div id="ytRecCard2" class="yt-rec-video-item yt-rec-hidden"></div>
            <div id="ytRecCard3" class="yt-rec-video-item yt-rec-hidden"></div>
        </div>
    </div>


      <div class="fifth-bloc">
        <div class="quote-container">
          
          <div class="einstein-image">
            <img src="Einstein.png" alt="Einstein">
          </div>
          
          <div class="quote-content">
            <div class="bloc-title">Quote of the Day</div>
            <div class="bloc-text">
              <a><i>"Logic will get you from A to Z, imagination will get you everywhere."</i> — Albert Einstein</a>
            </div>
          </div>      
        </div>
      </div>
      
      
      
        
    <footer id="contact">
      <div class="ep-square">
        <img src="genius by ymg 2.svg" alt="Image Enlightened" style ="height: 50px; width: 50px; margin-bottom: -10px;">
      </div>
        <p class="footer-text"><b> Pursue your enlightenment :</b></p>
        <div class="social-icons">
            <a href="https://www.instagram.com/enlightened.genius/" target="_blank">
                <i class="fab fa-instagram"></i>
            </a>
        </div>
        <p style = "font-size: 12px;">&copy; 2025 Genius</p>
    </footer>

    <button class="Btn scroll-to-top">
      <svg height="1.2em" class="arrow" viewBox="0 0 512 512">
        <path d="M233.4 105.4c12.5-12.5 32.8-12.5 45.3 0l192 192c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L256 173.3 86.6 342.6c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l192-192z"></path>
      </svg>
    </button>
    
    
    <script src="script.js"></script>
    
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const langSelect = document.getElementById("language-select");
        langSelect.value = "index.html"; // Force affichage English
    
        langSelect.addEventListener("change", function () {
          if (this.value !== "index.html") {
            window.location.href = this.value;
          }
        });
      });
      document.addEventListener("DOMContentLoaded", function () {
        const langSelect = document.getElementById("language-select-mobile");
        langSelect.value = "index.html"; // Force affichage English
    
        langSelect.addEventListener("change", function () {
          if (this.value !== "index.html") {
            window.location.href = this.value;
          }
        });
      });
    </script> 
    <script type="module">
        // Importation des modules Firebase nécessaires
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Variables globales pour Firebase
        let app;
        let db;
        let auth;
        let userId;

        // Récupération des variables globales fournies par l'environnement Canvas
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
        // API Key fournie par l'environnement Canvas
        const CANVAS_API_KEY = typeof __api_key !== 'undefined' ? __api_key : '';

        // Initialisation de Firebase et authentification
        async function initializeFirebase() {
            try {
                if (Object.keys(firebaseConfig).length > 0) {
                    app = initializeApp(firebaseConfig);
                    db = getFirestore(app);
                    auth = getAuth(app);

                    if (initialAuthToken) {
                        await signInWithCustomToken(auth, initialAuthToken);
                    } else {
                        await signInAnonymously(auth);
                    }
                    userId = auth.currentUser?.uid || crypto.randomUUID();
                    console.log("Firebase initialisé et utilisateur authentifié:", userId);
                } else {
                    console.warn("Firebase config non disponible. Certaines fonctionnalités pourraient être limitées.");
                    // Fallback pour userId si Firebase n'est pas initialisé
                    userId = crypto.randomUUID();
                }
            } catch (error) {
                console.error("Erreur lors de l'initialisation de Firebase ou de l'authentification:", error);
                ytRecShowMessage("Une erreur est survenue lors de l'initialisation. Veuillez réessayer.", "error");
                // Fallback pour userId en cas d'erreur
                userId = crypto.randomUUID();
            }
        }

        // Fonction pour afficher des messages à l'utilisateur (préfixée)
        function ytRecShowMessage(message, type = "info") {
            const messageBox = document.getElementById('ytRecMessageBox');
            messageBox.textContent = message;
            messageBox.className = `yt-rec-message-box ${type === 'error' ? 'yt-rec-message-box error' : ''} block`;
        }

        // Fonction pour cacher les messages (préfixée)
        function ytRecHideMessage() {
            const messageBox = document.getElementById('ytRecMessageBox');
            messageBox.textContent = '';
            messageBox.className = 'yt-rec-message-box hidden';
        }

        // Fonction pour afficher/cacher le spinner de chargement (préfixée)
        function ytRecToggleLoading(show) {
            const spinner = document.getElementById('ytRecLoadingSpinner');
            const button = document.getElementById('ytRecRefreshButton');
            if (show) {
                spinner.style.display = 'block';
                if (button) {
                    button.disabled = true;
                    button.classList.add('yt-rec-btn-disabled');
                }
            } else {
                spinner.style.display = 'none';
                if (button) {
                    button.disabled = false;
                    button.classList.remove('yt-rec-btn-disabled');
                }
            }
        }

        // Fonction pour générer des recommandations via l'API Gemini
        async function generateRecommendations() {
            ytRecToggleLoading(true);
            ytRecHideMessage();

            const recommendationCards = [
                document.getElementById('ytRecCard1'),
                document.getElementById('ytRecCard2'),
                document.getElementById('ytRecCard3')
            ];

            // Masquer et vider toutes les cartes avant de les remplir
            recommendationCards.forEach(card => {
                if (card) {
                    card.innerHTML = '';
                    card.classList.add('hidden');
                }
            });

            try {
                const prompt = "Génère 3 recommandations de vidéos YouTube sur des sujets diversifiés (géopolitique, mathématiques, physique, psychologie, histoire, technologie, art, philosophie). Pour chaque recommandation, inclue un titre de vidéo, une courte description (environ 20-30 mots), et un terme de recherche pertinent pour YouTube. Le format de sortie doit être un tableau JSON d'objets, où chaque objet a les propriétés 'title', 'description', et 'searchTerm'.";
                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });

                const payload = {
                    contents: chatHistory,
                    generationConfig: {
                        responseMimeType: "application/json",
                        responseSchema: {
                            type: "ARRAY",
                            items: {
                                type: "OBJECT",
                                properties: {
                                    "title": { "type": "STRING" },
                                    "description": { "type": "STRING" },
                                    "searchTerm": { "type": "STRING" }
                                },
                                "propertyOrdering": ["title", "description", "searchTerm"]
                            }
                        }
                    }
                };

                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${CANVAS_API_KEY}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(`Erreur API: ${response.status} - ${errorData.error?.message || response.statusText}`);
                }

                const result = await response.json();
                console.log("Réponse de l'API Gemini:", result);

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const jsonString = result.candidates[0].content.parts[0].text;
                    const recommendations = JSON.parse(jsonString);
                    console.log("Recommandations parsées:", recommendations);

                    if (Array.isArray(recommendations) && recommendations.length > 0) {
                        recommendations.slice(0, 3).forEach((rec, index) => {
                            if (recommendationCards[index]) {
                                const encodedTerm = encodeURIComponent(rec.searchTerm);
                                const placeholderImage = `https://placehold.co/320x180/E0E0E0/333333?text=Video+${index + 1}`;
                                // URL de recherche YouTube CORRIGÉE
                                const youtubeSearchUrl = `https://www.youtube.com/results?search_query=${encodedTerm}`;

                                recommendationCards[index].innerHTML = `
                                    <a href="${youtubeSearchUrl}" target="_blank" class="yt-rec-video-preview">
                                        <img src="${placeholderImage}" alt="Miniature de vidéo" onerror="this.onerror=null;this.src='https://placehold.co/320x180/CCCCCC/666666?text=Image+non+disponible';">
                                    </a>
                                    <h3 class="yt-rec-video-title">${rec.title}</h3>
                                    <p class="yt-rec-video-description">${rec.description}</p>
                                    <a href="${youtubeSearchUrl}" target="_blank" rel="noopener noreferrer" class="yt-rec-video-link">
                                        Voir sur YouTube
                                    </a>
                                `;
                                recommendationCards[index].classList.remove('hidden');
                            }
                        });
                    } else {
                        ytRecShowMessage("L'IA n'a pas pu générer de recommandations valides. Veuillez réessayer.", "error");
                    }
                } else {
                    ytRecShowMessage("Aucune recommandation n'a pu être générée. Veuillez réessayer.", "error");
                }
            } catch (error) {
                console.error("Erreur lors de la génération des recommandations:", error);
                ytRecShowMessage(`Erreur: ${error.message}. Impossible de générer les recommandations.`, "error");
            } finally {
                ytRecToggleLoading(false);
            }
        }

        // Écouteur d'événements pour le bouton de rafraîchissement (ID préfixé)
        document.addEventListener('DOMContentLoaded', async () => {
            await initializeFirebase();
            generateRecommendations();

            const refreshButton = document.getElementById('ytRecRefreshButton');
            if (refreshButton) {
                refreshButton.addEventListener('click', generateRecommendations);
            } else {
                console.error("Bouton de rafraîchissement (ytRecRefreshButton) non trouvé.");
            }
        });
    </script>   
    
</body>
</html>
